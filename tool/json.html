<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>json格式化</title>
		<meta name="viewport"
			content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			* {
				padding: 0;
				margin: 0;
				box-sizing: border-box;
				font-family: '楷体';
			}

			.wrap {
				position: absolute;
				left: 0;
				top: 0;
				right: 0;
				bottom: 0;
				display: flex;
				flex-direction: column;
			}

			.handle {
				height: 30px;
				display: flex;
				/* justify-content: center; */
				align-items: center;
			}

			.handle .each {
				line-height: 18px;
			}

			.handle .open,
			.handle .close,
			.handle .choose {
				margin-left: 12px;
				border: 1px solid #fff;
				color:#6699cc;
			}

			.handle .open:hover,
			.handle .close:hover,
			.handle .choose:hover {
				cursor: pointer;
				border: 1px solid #6699cc;
				color:#6699cc;
			}

			.write {
				flex: 1;
				outline: 0px solid transparent;
			}
		</style>
	</head>
	<body>
		<div class="wrap">

			<div class='handle'>
				<div class='each title'>工具名:JSON格式化</div>
				<div class='each choose'>全选</div>
				<div class="each open">展开</div>
				<div class='each close'>合并</div>
			</div>

			<div class="write" contenteditable="plaintext-only"></div>
		</div>

		<script>
			let openEl = document.querySelector('.open')
			let closeEl = document.querySelector('.close')
			let chooseEl = document.querySelector('.choose')
			let writeEl = document.querySelector('.write')



			openEl.addEventListener('click', function() {
				let jsonStr = writeEl.innerHTML;
				console.log(jsonStr)
				try {
					let obj = JSON.parse(jsonStr)
					let formatStr = JSON.stringify(obj, null, ' ');
					writeEl.innerHTML = formatStr
					writeEl.style.color = 'black';
				} catch (e) {
					writeEl.style.color = 'red';
				}
			})
			closeEl.addEventListener('click', function() {
				try {
					let jsonStr = writeEl.innerHTML;
					let obj = JSON.parse(jsonStr)
					let formatStr = JSON.stringify(obj, null, '');
					writeEl.innerHTML = formatStr
					writeEl.style.color = 'black';
				} catch (e) {
					writeEl.style.color = 'red';
				}
			})

			chooseEl.addEventListener('click', function() {
				const range = document.createRange()
				range.selectNodeContents(writeEl)
				window.getSelection().removeAllRanges() // 清楚其他的选中状态
				window.getSelection().addRange(range) // 添加元素选中住那个改				
			})

			writeEl.focus()
		</script>
	</body>
</html>
